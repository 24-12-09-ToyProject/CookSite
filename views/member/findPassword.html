{% extends "common/layout.html" %}

{% block extra_styles %}
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.css">
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.js"></script>
	<link rel="stylesheet" href="/static/css/member/findPassword.css">
{% endblock %}


{% block content %}
<h2>비밀번호 찾기</h2>
<form id="find-password" action="/find-password" method="post">
	<label for="id">아이디</label>
	<input type="text" id="memberId" name="memberId" autocomplete="off" required>

	<div>
		<input id="email" type="text" class="required" name="email" autocomplete="off" lang="en">@
		<select name="emailDomain" id="email-domain">
			<option value="@naver.com">naver.com</option>
		</select>
	</div>


	<button type="button" onclick="findMemberPw();">비밀번호 찾기</button>
</form>
<script>
	const elMemberId = document.querySelector('#memberId');
	const elEmail = document.querySelector('#email');
	const elEmailDomain = document.querySelector('#email-domain');
	const findPwForm = document.querySelector('#find-password');
	async function findMemberPw(){
		// 아이디 입력확인
		// 이메일 입력확인
		// id 필수입력 체크
	if(elMemberId.value === ""){
		alert("아이디를 입력해주세요");
		return;
	}
	
	// pw 필수입력 체크
	if(elEmail.value === ""){
		alert("이메일을 입력해주세요");
		return;
	}
	// 1. 아이디, 이메일 계정 존재하는 확인
	const response = await fetch('/member/api/find-pw', {
		method: 'POST',
		headers: {
			'Content-Type': 'application/json',
		},
		body: JSON.stringify({ memberId:elMemberId.value, email:elEmail.value + elEmailDomain.value})
	});

	const result = await response.json();

	if (result.success) {
		Swal.fire({
				icon: 'success',
				title: 'Alert가 실행되었습니다.',
				text: '이메일로 비밀번호 재설정 링크를 보냈습니다',
		});
	} else {
		Swal.fire({
				icon: 'warning',
				title: 'Alert가 실행되었습니다.',
				text: "계정이 존재하지 않습니다",
		});
	}

	// 2. 해당 이메일로 비밀번호 재설정 링크 보내기 -> jwt토큰 이용



		// 
	}
</script>
{% endblock %}

{% block extra_scripts %}
<script src="/static/js/member/findPassword.js"></script>
{% endblock %}